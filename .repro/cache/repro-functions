

function repro.get-prefix-path {
    unset path_prefix
    readarray paths < ${REPRO_PATHS_FILE}
    for path_line in "${paths[@]}"
    do
        new_path=$(echo "$path_line" | envsubst | xargs )
        if [[ -v path_prefix ]] ; then
            path_prefix=${new_path}:${path_prefix}
        else
            path_prefix=${new_path}
        fi
    done
    echo ${path_prefix}
}

function repro.get-module-path {
    unset module_path
    readarray modules < ${REPRO_ORDER_FILE}
    for module_name in "${modules[@]}"
    do
        read -ra tokens < ${REPRO_INDEX_DIR}/${module_name}
        module_dir=${tokens[2]}
        if [[ -v module_path ]] ; then
            module_path=${module_dir}:${module_path}
        else
            module_path=${module_dir}
        fi
    done
    echo ${module_path}
}

function repro.update-path {
        
    updated_path=${REPRO_BASE_PATH}
    
    module_path=$(repro.get-module-path)
    if [[ ! -z ${module_path} ]] ; then
        updated_path=${module_path}:${updated_path}
    fi
    
    path_prefix=$(repro.get-prefix-path)
    if [[ ! -z ${path_prefix} ]] ; then
        updated_path=${path_prefix}:${updated_path}
    fi
    
    export PATH=${updated_path}
}


